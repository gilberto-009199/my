/*! SmartMenus jQuery Plugin - v1.0.0-beta1 - June 1, 2015
 * http://www.smartmenus.org/
 * Copyright 2015 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com; Licensed MIT */
(function(l){function f(h){var n=".smartmenus_mouse";if(g||h){g&&h&&(l(document).unbind(n),g=!1)}else{var e=!0,a=null;l(document).bind(c([["mousemove",function(p){var u={x:p.pageX,y:p.pageY,timeStamp:(new Date).getTime()};if(a){var q=Math.abs(a.x-u.x),v=Math.abs(a.y-u.y);if((q>0||v>0)&&2>=q&&2>=v&&300>=u.timeStamp-a.timeStamp&&(d=!0,e)){var t=l(p.target).closest("a");t.is("a")&&l.each(k,function(){return l.contains(this.$root[0],t[0])?(this.itemEnter({currentTarget:t[0]}),!1):void 0}),e=!1}}a=u}],[m()?"touchstart":"pointerover pointermove pointerout MSPointerOver MSPointerMove MSPointerOut",function(i){j(i.originalEvent)&&(d=!1)}]],n)),g=!0}}function j(a){return !/^(4|mouse)$/.test(a.pointerType)}function m(){return"ontouchstart" in window}function c(a,n){n||(n="");var h={};return l.each(a,function(o,e){h[e[0].split(" ").join(n+" ")+n]=e[1]}),h}var k=[],b=!!window.createPopup,d=!1,g=!1;l.SmartMenus=function(a,h){this.$root=l(a),this.opts=h,this.rootId="",this.accessIdPrefix="",this.$subArrow=null,this.activatedItems=[],this.visibleSubMenus=[],this.showTimeout=0,this.hideTimeout=0,this.scrollTimeout=0,this.clickActivated=!1,this.focusActivated=!1,this.zIndexInc=0,this.idInc=0,this.$firstLink=null,this.$firstSub=null,this.disabled=!1,this.$disableOverlay=null,this.isTouchScrolling=!1,this.wasCollapsible=!1,this.init()},l.extend(l.SmartMenus,{hideAll:function(){l.each(k,function(){this.menuHideAll()})},destroy:function(){for(;k.length;){k[0].destroy()}f(!0)},prototype:{init:function(t){var p=this;if(!t){k.push(this),this.rootId=((new Date).getTime()+Math.random()+"").replace(/\D/g,""),this.accessIdPrefix="sm-"+this.rootId+"-",this.$root.hasClass("sm-rtl")&&(this.opts.rightToLeftSubMenus=!0);var q=".smartmenus";this.$root.data("smartmenus",this).attr("data-smartmenus-id",this.rootId).dataSM("level",1).bind(c([["mouseover focusin",l.proxy(this.rootOver,this)],["mouseout focusout",l.proxy(this.rootOut,this)],["keydown",l.proxy(this.rootKeyDown,this)]],q)).delegate("a",c([["mouseenter",l.proxy(this.itemEnter,this)],["mouseleave",l.proxy(this.itemLeave,this)],["mousedown",l.proxy(this.itemDown,this)],["focus",l.proxy(this.itemFocus,this)],["blur",l.proxy(this.itemBlur,this)],["click",l.proxy(this.itemClick,this)],["touchend",l.proxy(this.itemTouchEnd,this)]],q)),q+=this.rootId,this.opts.hideOnClick&&l(document).bind(c([["touchstart",l.proxy(this.docTouchStart,this)],["touchmove",l.proxy(this.docTouchMove,this)],["touchend",l.proxy(this.docTouchEnd,this)],["click",l.proxy(this.docClick,this)]],q)),l(window).bind(c([["resize orientationchange",l.proxy(this.winResize,this)]],q)),this.opts.subIndicators&&(this.$subArrow=l("<span/>").addClass("sub-arrow"),this.opts.subIndicatorsText&&this.$subArrow.html(this.opts.subIndicatorsText)),f()}if(this.$firstSub=this.$root.find("ul").each(function(){p.menuInit(l(this))}).eq(0),this.$firstLink=this.$root.find("a").eq(0),this.opts.markCurrentItem){var v=/(index|default)\.[^#\?\/]*/i,o=/#.*/,i=window.location.href.replace(v,""),a=i.replace(o,"");this.$root.find("a").each(function(){var h=this.href.replace(v,""),n=l(this);(h==i||h==a)&&(n.addClass("current"),p.opts.markCurrentTree&&n.parentsUntil("[data-smartmenus-id]","ul").each(function(){l(this).dataSM("parent-a").addClass("current")}))})}this.wasCollapsible=this.isCollapsible()},destroy:function(a){if(!a){var n=".smartmenus";this.$root.removeData("smartmenus").removeAttr("data-smartmenus-id").removeDataSM("level").unbind(n).undelegate(n),n+=this.rootId,l(document).unbind(n),l(window).unbind(n),this.opts.subIndicators&&(this.$subArrow=null)}this.menuHideAll();var h=this;this.$root.find("ul").each(function(){var e=l(this);e.dataSM("scroll-arrows")&&e.dataSM("scroll-arrows").remove(),e.dataSM("shown-before")&&((h.opts.subMenusMinWidth||h.opts.subMenusMaxWidth)&&e.css({width:"",minWidth:"",maxWidth:""}).removeClass("sm-nowrap"),e.dataSM("scroll-arrows")&&e.dataSM("scroll-arrows").remove(),e.css({zIndex:"",top:"",left:"",marginLeft:"",marginTop:"",display:""})),0==e.attr("id").indexOf(h.accessIdPrefix)&&e.removeAttr("id")}).removeDataSM("in-mega").removeDataSM("shown-before").removeDataSM("ie-shim").removeDataSM("scroll-arrows").removeDataSM("parent-a").removeDataSM("level").removeDataSM("beforefirstshowfired").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeAttr("aria-expanded"),this.$root.find("a.has-submenu").each(function(){var e=l(this);0==e.attr("id").indexOf(h.accessIdPrefix)&&e.removeAttr("id")}).removeClass("has-submenu").removeDataSM("sub").removeAttr("aria-haspopup").removeAttr("aria-controls").removeAttr("aria-expanded").closest("li").removeDataSM("sub"),this.opts.subIndicators&&this.$root.find("span.sub-arrow").remove(),this.opts.markCurrentItem&&this.$root.find("a.current").removeClass("current"),a||(this.$root=null,this.$firstLink=null,this.$firstSub=null,this.$disableOverlay&&(this.$disableOverlay.remove(),this.$disableOverlay=null),k.splice(l.inArray(this,k),1))},disable:function(a){if(!this.disabled){if(this.menuHideAll(),!a&&!this.opts.isPopup&&this.$root.is(":visible")){var h=this.$root.offset();this.$disableOverlay=l('<div class="sm-jquery-disable-overlay"/>').css({position:"absolute",top:h.top,left:h.left,width:this.$root.outerWidth(),height:this.$root.outerHeight(),zIndex:this.getStartZIndex(!0),opacity:0}).appendTo(document.body)}this.disabled=!0}},docClick:function(a){return this.isTouchScrolling?(this.isTouchScrolling=!1,void 0):((this.visibleSubMenus.length&&!l.contains(this.$root[0],a.target)||l(a.target).is("a"))&&this.menuHideAll(),void 0)},docTouchEnd:function(){if(this.lastTouch){if(!(!this.visibleSubMenus.length||void 0!==this.lastTouch.x2&&this.lastTouch.x1!=this.lastTouch.x2||void 0!==this.lastTouch.y2&&this.lastTouch.y1!=this.lastTouch.y2||this.lastTouch.target&&l.contains(this.$root[0],this.lastTouch.target))){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0);var a=this;this.hideTimeout=setTimeout(function(){a.menuHideAll()},350)}this.lastTouch=null}},docTouchMove:function(e){if(this.lastTouch){var a=e.originalEvent.touches[0];this.lastTouch.x2=a.pageX,this.lastTouch.y2=a.pageY}},docTouchStart:function(e){var a=e.originalEvent.touches[0];this.lastTouch={x1:a.pageX,y1:a.pageY,target:a.target}},enable:function(){this.disabled&&(this.$disableOverlay&&(this.$disableOverlay.remove(),this.$disableOverlay=null),this.disabled=!1)},getClosestMenu:function(a){for(var h=l(a).closest("ul");h.dataSM("in-mega");){h=h.parent().closest("ul")}return h[0]||null},getHeight:function(a){return this.getOffset(a,!0)},getOffset:function(h,a){var p;"none"==h.css("display")&&(p={position:h[0].style.position,visibility:h[0].style.visibility},h.css({position:"absolute",visibility:"hidden"}).show());var n=h[0].getBoundingClientRect&&h[0].getBoundingClientRect(),q=n&&(a?n.height||n.bottom-n.top:n.width||n.right-n.left);return q||0===q||(q=a?h[0].offsetHeight:h[0].offsetWidth),p&&h.hide().css(p),q},getStartZIndex:function(e){var a=parseInt(this[e?"$root":"$firstSub"].css("z-index"));return !e&&isNaN(a)&&(a=parseInt(this.$root.css("z-index"))),isNaN(a)?1:a},getTouchPoint:function(a){return a.touches&&a.touches[0]||a.changedTouches&&a.changedTouches[0]||a},getViewport:function(h){var a=h?"Height":"Width",o=document.documentElement["client"+a],n=window["inner"+a];return n&&(o=Math.min(o,n)),o},getViewportHeight:function(){return this.getViewport(!0)},getViewportWidth:function(){return this.getViewport()},getWidth:function(a){return this.getOffset(a)},handleEvents:function(){return !this.disabled&&this.isCSSOn()},handleItemEvents:function(a){return this.handleEvents()&&!this.isLinkInMegaMenu(a)},isCollapsible:function(){return"static"==this.$firstSub.css("position")},isCSSOn:function(){return"block"==this.$firstLink.css("display")},isFixed:function(){var a="fixed"==this.$root.css("position");return a||this.$root.parentsUntil("body").each(function(){return"fixed"==l(this).css("position")?(a=!0,!1):void 0}),a},isLinkInMegaMenu:function(a){return l(this.getClosestMenu(a[0])).hasClass("mega-menu")},isTouchMode:function(){return !d||this.isCollapsible()},itemActivate:function(n,t){var p=n.closest("ul"),u=p.dataSM("level");if(u>1&&(!this.activatedItems[u-2]||this.activatedItems[u-2][0]!=p.dataSM("parent-a")[0])){var h=this;l(p.parentsUntil("[data-smartmenus-id]","ul").get().reverse()).add(p).each(function(){h.itemActivate(l(this).dataSM("parent-a"))})}if((!this.isCollapsible()||t)&&this.menuHideSubMenus(this.activatedItems[u-1]&&this.activatedItems[u-1][0]==n[0]?u:u-1),this.activatedItems[u-1]=n,this.$root.triggerHandler("activate.smapi",n[0])!==!1){var q=n.dataSM("sub");q&&(this.isTouchMode()||!this.opts.showOnClick||this.clickActivated)&&this.menuShow(q)}},itemBlur:function(a){var h=l(a.currentTarget);this.handleItemEvents(h)&&this.$root.triggerHandler("blur.smapi",h[0])},itemClick:function(a){if(this.isTouchScrolling){return this.isTouchScrolling=!1,a.stopPropagation(),!1}var n=l(a.currentTarget);if(this.handleItemEvents(n)){if(this.$root.triggerHandler("click.smapi",n[0])===!1){return !1}n.dataSM("href")&&n.attr("href",n.dataSM("href")).removeDataSM("href");var h=l(a.target).is("span.sub-arrow"),p=n.dataSM("sub");if(p&&!p.is(":visible")){if(this.itemActivate(n),p.is(":visible")){return this.focusActivated=!0,!1}}else{if(this.isCollapsible()&&h){return this.itemActivate(n),this.menuHide(p),!1}}return this.opts.showOnClick&&p&&2==p.dataSM("level")?(this.clickActivated=!0,this.menuShow(p),!1):n.hasClass("disabled")?!1:this.$root.triggerHandler("select.smapi",n[0])===!1?!1:void 0}},itemDown:function(a){var h=l(a.currentTarget);this.handleItemEvents(h)&&h.dataSM("mousedown",!0)},itemEnter:function(a){var n=l(a.currentTarget);if(this.handleItemEvents(n)){if(!this.isTouchMode()){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=0);var h=this;this.showTimeout=setTimeout(function(){h.itemActivate(n)},this.opts.showOnClick&&1==n.closest("ul").dataSM("level")?1:this.opts.showTimeout)}this.$root.triggerHandler("mouseenter.smapi",n[0])}},itemFocus:function(a){var h=l(a.currentTarget);this.handleItemEvents(h)&&(!this.focusActivated||this.isTouchMode()&&h.dataSM("mousedown")||this.activatedItems.length&&this.activatedItems[this.activatedItems.length-1][0]==h[0]||this.itemActivate(h,!0),this.$root.triggerHandler("focus.smapi",h[0]))},itemLeave:function(a){var h=l(a.currentTarget);this.handleItemEvents(h)&&(this.isTouchMode()||this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=0),h.removeDataSM("mousedown"),this.$root.triggerHandler("mouseleave.smapi",h[0]))},itemTouchEnd:function(a){var n=l(a.currentTarget);if(this.handleItemEvents(n)){var h=n.dataSM("sub");"#"!==n.attr("href").charAt(0)&&h&&!h.is(":visible")&&n.dataSM("href",n.attr("href")).attr("href","#")}},menuHide:function(a){if(this.$root.triggerHandler("beforehide.smapi",a[0])!==!1&&(a.stop(!0,!0),"none"!=a.css("display"))){var n=function(){a.css("z-index","")};this.isCollapsible()?this.opts.collapsibleHideFunction?this.opts.collapsibleHideFunction.call(this,a,n):a.hide(this.opts.collapsibleHideDuration,n):this.opts.hideFunction?this.opts.hideFunction.call(this,a,n):a.hide(this.opts.hideDuration,n),a.dataSM("ie-shim")&&a.dataSM("ie-shim").remove(),a.dataSM("scroll")&&(this.menuScrollStop(a),a.css({"touch-action":"","-ms-touch-action":""}).unbind(".smartmenus_scroll").removeDataSM("scroll").dataSM("scroll-arrows").hide()),a.dataSM("parent-a").removeClass("highlighted").attr("aria-expanded","false"),a.attr({"aria-expanded":"false","aria-hidden":"true"});var h=a.dataSM("level");this.activatedItems.splice(h-1,1),this.visibleSubMenus.splice(l.inArray(a,this.visibleSubMenus),1),this.$root.triggerHandler("hide.smapi",a[0])}},menuHideAll:function(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=0);for(var e=this.opts.isPopup?1:0,a=this.visibleSubMenus.length-1;a>=e;a--){this.menuHide(this.visibleSubMenus[a])}this.opts.isPopup&&(this.$root.stop(!0,!0),this.$root.is(":visible")&&(this.opts.hideFunction?this.opts.hideFunction.call(this,this.$root):this.$root.hide(this.opts.hideDuration),this.$root.dataSM("ie-shim")&&this.$root.dataSM("ie-shim").remove())),this.activatedItems=[],this.visibleSubMenus=[],this.clickActivated=!1,this.focusActivated=!1,this.zIndexInc=0},menuHideSubMenus:function(h){for(var a=this.activatedItems.length-1;a>=h;a--){var n=this.activatedItems[a].dataSM("sub");n&&this.menuHide(n)}},menuIframeShim:function(a){b&&this.opts.overlapControlsInIE&&!a.dataSM("ie-shim")&&a.dataSM("ie-shim",l("<iframe/>").attr({src:"javascript:0",tabindex:-9}).css({position:"absolute",top:"auto",left:"0",opacity:0,border:"0"}))},menuInit:function(p){if(!p.dataSM("in-mega")){p.hasClass("mega-menu")&&p.find("ul").dataSM("in-mega",!0);for(var n=2,r=p[0];(r=r.parentNode.parentNode)!=this.$root[0];){n++}var q=p.prevAll("a").eq(-1);q.length||(q=p.prevAll().find("a").eq(-1)),q.addClass("has-submenu").dataSM("sub",p),p.dataSM("parent-a",q).dataSM("level",n).parent().dataSM("sub",p);var u=q.attr("id")||this.accessIdPrefix+ ++this.idInc,h=p.attr("id")||this.accessIdPrefix+ ++this.idInc;q.attr({id:u,"aria-haspopup":"true","aria-controls":h,"aria-expanded":"false"}),p.attr({id:h,role:"group","aria-hidden":"true","aria-labelledby":u,"aria-expanded":"false"}),this.opts.subIndicators&&q[this.opts.subIndicatorsPos](this.$subArrow.clone())}},menuPosition:function(U){var Y,ac,L=U.dataSM("parent-a"),P=L.closest("li"),V=P.parent(),J=U.dataSM("level"),R=this.getWidth(U),aa=this.getHeight(U),Z=L.offset(),Q=Z.left,O=Z.top,X=this.getWidth(L),G=this.getHeight(L),ab=l(window),s=ab.scrollLeft(),W=ab.scrollTop(),t=this.getViewportWidth(),F=this.getViewportHeight(),o=V.hasClass("sm")&&!V.hasClass("sm-vertical"),D=this.opts.rightToLeftSubMenus&&!P.is("[data-sm-reverse]")||!this.opts.rightToLeftSubMenus&&P.is("[data-sm-reverse]"),q=2==J?this.opts.mainMenuSubOffsetX:this.opts.subMenusSubOffsetX,B=2==J?this.opts.mainMenuSubOffsetY:this.opts.subMenusSubOffsetY;if(o?(Y=D?X-R-q:q,ac=this.opts.bottomToTopSubMenus?-aa-B:G+B):(Y=D?q-R:X-q,ac=this.opts.bottomToTopSubMenus?G-B-aa:B),this.opts.keepInViewport){var z=Q+Y,K=O+ac;if(D&&s>z?Y=o?s-z+Y:X-q:!D&&z+R>s+t&&(Y=o?s+t-R-z+Y:q-R),o||(F>aa&&K+aa>W+F?ac+=W+F-aa-K:(aa>=F||W>K)&&(ac+=W-K)),o&&(K+aa>W+F+0.49||W>K)||!o&&aa>F+0.49){var E=this;U.dataSM("scroll-arrows")||U.dataSM("scroll-arrows",l([l('<span class="scroll-up"><span class="scroll-up-arrow"></span></span>')[0],l('<span class="scroll-down"><span class="scroll-down-arrow"></span></span>')[0]]).bind({mouseenter:function(){U.dataSM("scroll").up=l(this).hasClass("scroll-up"),E.menuScroll(U)},mouseleave:function(a){E.menuScrollStop(U),E.menuScrollOut(U,a)},"mousewheel DOMMouseScroll":function(a){a.preventDefault()}}).insertAfter(U));var N=".smartmenus_scroll";U.dataSM("scroll",{step:1,itemH:G,subH:aa,arrowDownH:this.getHeight(U.dataSM("scroll-arrows").eq(1))}).bind(c([["mouseover",function(a){E.menuScrollOver(U,a)}],["mouseout",function(a){E.menuScrollOut(U,a)}],["mousewheel DOMMouseScroll",function(a){E.menuScrollMousewheel(U,a)}]],N)).dataSM("scroll-arrows").css({top:"auto",left:"0",marginLeft:Y+(parseInt(U.css("border-left-width"))||0),width:R-(parseInt(U.css("border-left-width"))||0)-(parseInt(U.css("border-right-width"))||0),zIndex:U.css("z-index")}).eq(o&&this.opts.bottomToTopSubMenus?0:1).show(),this.isFixed()&&U.css({"touch-action":"none","-ms-touch-action":"none"}).bind(c([[m()?"touchstart touchmove touchend":"pointerdown pointermove pointerup MSPointerDown MSPointerMove MSPointerUp",function(a){E.menuScrollTouch(U,a)}]],N))}}U.css({top:"auto",left:"0",marginLeft:Y,marginTop:ac-G}),this.menuIframeShim(U),U.dataSM("ie-shim")&&U.dataSM("ie-shim").css({zIndex:U.css("z-index"),width:R,height:aa,marginLeft:Y,marginTop:ac-G})},menuScroll:function(B,v,x){var C,p=B.dataSM("scroll"),z=B.dataSM("scroll-arrows"),n=parseFloat(B.css("margin-top")),w=p.up?p.upEnd:p.downEnd;if(!v&&p.velocity){if(p.velocity*=0.9,C=p.velocity,0.5>C){return this.menuScrollStop(B),void 0}}else{C=x||(v||!this.opts.scrollAccelerate?this.opts.scrollStep:Math.floor(p.step))}var A=B.dataSM("level");this.activatedItems[A-1]&&this.activatedItems[A-1].dataSM("sub")&&this.activatedItems[A-1].dataSM("sub").is(":visible")&&this.menuHideSubMenus(A-1);var q=p.up&&n>=w||!p.up&&w>=n?n:Math.abs(w-n)>C?n+(p.up?C:-C):w;if(B.add(B.dataSM("ie-shim")).css("margin-top",q),d&&(p.up&&q>p.downEnd||!p.up&&p.upEnd>q)&&z.eq(p.up?1:0).show(),q==w){d&&z.eq(p.up?0:1).hide(),this.menuScrollStop(B)}else{if(!v){this.opts.scrollAccelerate&&p.step<this.opts.scrollStep&&(p.step+=0.5);var y=this;this.scrollTimeout=setTimeout(function(){y.menuScroll(B)},this.opts.scrollInterval)}}},menuScrollMousewheel:function(h,a){if(this.getClosestMenu(a.target)==h[0]){a=a.originalEvent;var n=(a.wheelDelta||-a.detail)>0;h.dataSM("scroll-arrows").eq(n?0:1).is(":visible")&&(h.dataSM("scroll").up=n,this.menuScroll(h,!0))}a.preventDefault()},menuScrollOut:function(a,h){d&&(/^scroll-(up|down)/.test((h.relatedTarget||"").className)||(a[0]==h.relatedTarget||l.contains(a[0],h.relatedTarget))&&this.getClosestMenu(h.relatedTarget)==a[0]||a.dataSM("scroll-arrows").css("visibility","hidden"))},menuScrollOver:function(h,a){if(d&&!/^scroll-(up|down)/.test(a.target.className)&&this.getClosestMenu(a.target)==h[0]){this.menuScrollRefreshData(h);var n=h.dataSM("scroll");h.dataSM("scroll-arrows").eq(0).css("margin-top",n.upEnd).end().eq(1).css("margin-top",n.downEnd+n.subH-n.arrowDownH).end().css("visibility","visible")}},menuScrollRefreshData:function(a){var n=a.dataSM("scroll"),h=l(window),p=h.scrollTop()-a.dataSM("parent-a").offset().top-n.itemH;l.extend(n,{upEnd:p,downEnd:p+this.getViewportHeight()-n.subH})},menuScrollStop:function(a){return this.scrollTimeout?(clearTimeout(this.scrollTimeout),this.scrollTimeout=0,l.extend(a.dataSM("scroll"),{step:1,velocity:0}),!0):void 0},menuScrollTouch:function(h,n){if(n=n.originalEvent,j(n)){var q=this.getTouchPoint(n);if(this.getClosestMenu(q.target)==h[0]){var e=h.dataSM("scroll");if(/(start|down)$/i.test(n.type)){this.menuScrollStop(h)?(n.preventDefault(),this.isTouchScrolling=!0):this.isTouchScrolling=!1,this.menuScrollRefreshData(h),l.extend(e,{touchY:q.pageY,touchTimestamp:n.timeStamp,velocity:0})}else{if(/move$/i.test(n.type)){var p=e.touchY;void 0!==p&&p!=q.pageY&&(this.isTouchScrolling=!0,l.extend(e,{up:q.pageY>p,touchY:q.pageY,touchTimestamp:n.timeStamp,velocity:e.velocity+0.5*Math.abs(q.pageY-p)}),this.menuScroll(h,!0,Math.abs(e.touchY-p))),n.preventDefault()}else{void 0!==e.touchY&&(120>n.timeStamp-e.touchTimestamp&&e.velocity>0&&(e.velocity*=0.5,this.menuScrollStop(h),this.menuScroll(h),n.preventDefault()),delete e.touchY)}}}}},menuShow:function(h){if((h.dataSM("beforefirstshowfired")||(h.dataSM("beforefirstshowfired",!0),this.$root.triggerHandler("beforefirstshow.smapi",h[0])!==!1))&&this.$root.triggerHandler("beforeshow.smapi",h[0])!==!1&&(h.dataSM("shown-before",!0).stop(!0,!0),!h.is(":visible"))){var a=h.dataSM("parent-a");if((this.opts.keepHighlighted||this.isCollapsible())&&a.addClass("highlighted"),this.isCollapsible()){h.removeClass("sm-nowrap").css({zIndex:"",width:"auto",minWidth:"",maxWidth:"",top:"",left:"",marginLeft:"",marginTop:""})}else{if(h.css("z-index",this.zIndexInc=(this.zIndexInc||this.getStartZIndex())+1),(this.opts.subMenusMinWidth||this.opts.subMenusMaxWidth)&&(h.css({width:"auto",minWidth:"",maxWidth:""}).addClass("sm-nowrap"),this.opts.subMenusMinWidth&&h.css("min-width",this.opts.subMenusMinWidth),this.opts.subMenusMaxWidth)){var o=this.getWidth(h);h.css("max-width",this.opts.subMenusMaxWidth),o>this.getWidth(h)&&h.removeClass("sm-nowrap").css("width",this.opts.subMenusMaxWidth)}this.menuPosition(h),h.dataSM("ie-shim")&&h.dataSM("ie-shim").insertBefore(h)}var n=function(){h.css("overflow","")};this.isCollapsible()?this.opts.collapsibleShowFunction?this.opts.collapsibleShowFunction.call(this,h,n):h.show(this.opts.collapsibleShowDuration,n):this.opts.showFunction?this.opts.showFunction.call(this,h,n):h.show(this.opts.showDuration,n),a.attr("aria-expanded","true"),h.attr({"aria-expanded":"true","aria-hidden":"false"}),this.visibleSubMenus.push(h),this.$root.triggerHandler("show.smapi",h[0])}},popupHide:function(e){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0);var a=this;this.hideTimeout=setTimeout(function(){a.menuHideAll()},e?1:this.opts.hideTimeout)},popupShow:function(h,a){if(!this.opts.isPopup){return alert('SmartMenus jQuery Error:\n\nIf you want to show this menu via the "popupShow" method, set the isPopup:true option.'),void 0}if(this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0),this.$root.dataSM("shown-before",!0).stop(!0,!0),!this.$root.is(":visible")){this.$root.css({left:h,top:a}),this.menuIframeShim(this.$root),this.$root.dataSM("ie-shim")&&this.$root.dataSM("ie-shim").css({zIndex:this.$root.css("z-index"),width:this.getWidth(this.$root),height:this.getHeight(this.$root),left:h,top:a}).insertBefore(this.$root);var o=this,n=function(){o.$root.css("overflow","")};this.opts.showFunction?this.opts.showFunction.call(this,this.$root,n):this.$root.show(this.opts.showDuration,n),this.visibleSubMenus[0]=this.$root}},refresh:function(){this.destroy(!0),this.init(!0)},rootKeyDown:function(a){if(this.handleEvents()){switch(a.keyCode){case 27:var n=this.activatedItems[0];if(n){this.menuHideAll(),n[0].focus();var h=n.dataSM("sub");h&&this.menuHide(h)}break;case 32:var p=l(a.target);if(p.is("a")&&this.handleItemEvents(p)){var h=p.dataSM("sub");h&&!h.is(":visible")&&(this.itemClick({currentTarget:a.target}),a.preventDefault())}}}},rootOut:function(e){if(this.handleEvents()&&!this.isTouchMode()&&e.target!=this.$root[0]&&(this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0),!this.opts.showOnClick||!this.opts.hideOnClick)){var a=this;this.hideTimeout=setTimeout(function(){a.menuHideAll()},this.opts.hideTimeout)}},rootOver:function(a){this.handleEvents()&&!this.isTouchMode()&&a.target!=this.$root[0]&&this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0)},winResize:function(h){if(this.handleEvents()){if(!("onorientationchange" in window)||"orientationchange"==h.type){var a=this.isCollapsible();this.wasCollapsible&&a||(this.activatedItems.length&&this.activatedItems[this.activatedItems.length-1][0].blur(),this.menuHideAll()),this.wasCollapsible=a}}else{if(this.$disableOverlay){var n=this.$root.offset();this.$disableOverlay.css({top:n.top,left:n.left,width:this.$root.outerWidth(),height:this.$root.outerHeight()})}}}}}),l.fn.dataSM=function(e,a){return a?this.data(e+"_smartmenus",a):this.data(e+"_smartmenus")},l.fn.removeDataSM=function(a){return this.removeData(a+"_smartmenus")},l.fn.smartmenus=function(a){if("string"==typeof a){var n=arguments,h=a;return Array.prototype.shift.call(n),this.each(function(){var e=l(this).data("smartmenus");e&&e[h]&&e[h].apply(e,n)})}var p=l.extend({},l.fn.smartmenus.defaults,a);return this.each(function(){new l.SmartMenus(this,p)})},l.fn.smartmenus.defaults={isPopup:!1,mainMenuSubOffsetX:0,mainMenuSubOffsetY:0,subMenusSubOffsetX:0,subMenusSubOffsetY:0,subMenusMinWidth:"10em",subMenusMaxWidth:"20em",subIndicators:!0,subIndicatorsPos:"prepend",subIndicatorsText:"+",scrollStep:30,scrollInterval:30,scrollAccelerate:!0,showTimeout:250,hideTimeout:500,showDuration:0,showFunction:null,hideDuration:0,hideFunction:function(e,a){e.fadeOut(200,a)},collapsibleShowDuration:0,collapsibleShowFunction:function(e,a){e.slideDown(200,a)},collapsibleHideDuration:0,collapsibleHideFunction:function(e,a){e.slideUp(200,a)},showOnClick:!1,hideOnClick:!0,keepInViewport:!0,keepHighlighted:!0,markCurrentItem:!1,markCurrentTree:!0,rightToLeftSubMenus:!1,bottomToTopSubMenus:!1,overlapControlsInIE:!0}})(jQuery);